{
  "tsup.config.ts": [
    "1: import { defineConfig } from 'tsup';",
    "2: ",
    "3: export default defineConfig({",
    "4:   entryPoints: ['src/index.ts', 'src/cli.ts'], // Include cli.ts",
    "5:   format: ['cjs', 'esm'],",
    "6:   dts: true,",
    "7:   outDir: 'dist',",
    "8:   clean: true,",
    "9: });",
    "10: "
  ],
  "tsup.config.js": [
    "1: import { defineConfig } from 'tsup';",
    "2: export default defineConfig({",
    "3:   entryPoints: ['src/index.ts'],",
    "4:   format: ['cjs', 'esm'],",
    "5:   dts: true,",
    "6:   outDir: 'dist',",
    "7:   clean: true,",
    "8: });",
    "9: //# sourceMappingURL=tsup.config.js.map",
    "10: "
  ],
  "tsup.config.d.ts": [
    "1: declare const _default:",
    "2:   | import('tsup').Options",
    "3:   | import('tsup').Options[]",
    "4:   | ((",
    "5:       overrideOptions: import('tsup').Options,",
    "6:     ) =>",
    "7:       | import('tsup').Options",
    "8:       | import('tsup').Options[]",
    "9:       | Promise<import('tsup').Options | import('tsup').Options[]>);",
    "10: export default _default;",
    "11: //# sourceMappingURL=tsup.config.d.ts.map",
    "12: "
  ],
  "src/utils.ts": [
    "1: import { OpenAI } from 'openai';",
    "2: import * as fs from 'fs/promises';",
    "3: import { exec } from 'child_process';",
    "4: import readline from 'readline';",
    "5: import { AxePuppeteer } from '@axe-core/puppeteer';",
    "6: import puppeteer from 'puppeteer';",
    "7: ",
    "8: interface ImproveSemanticsOptions {",
    "9:   htmlFilePath: string;",
    "10:   openAIApiKey: string;",
    "11:   openAIModel?: string;",
    "12:   openVSCode?: boolean;",
    "13: }",
    "14: ",
    "15: //Old Functions",
    "16: async function improveHtmlSemantics({",
    "17:   htmlFilePath,",
    "18:   openAIApiKey,",
    "19:   openAIModel = 'gpt-4o-mini',",
    "20:   openVSCode = true,",
    "21: }: ImproveSemanticsOptions): Promise<string> {",
    "22:   const client = new OpenAI({ apiKey: openAIApiKey });",
    "23: ",
    "24:   try {",
    "25:     const htmlContent = await fs.readFile(htmlFilePath, 'utf8');",
    "26: ",
    "27:     const prompt = `Please make the following HTML more semantic and accessible. Consider using header tags instead of just <p> or using <section>/<article> instead of <div> where appropriate. Do not response with any other words or content EXCEPT for the html code. This is extremely important. The file returned should be runnable as HTML code. E.g. shouldn't include dash tags. The first and final tag should be the first and final tag provided by the original html content e.g. <!doctype html>. Please do not write backticks at the start or end. e.g. backtick backtick backtick html which is commonly used by ai to display code nicely. please dont do this. Here is the HTML content:\\n\\n${htmlContent}`;",
    "28: ",
    "29:     const completion = await client.chat.completions.create({",
    "30:       model: openAIModel,",
    "31:       messages: [",
    "32:         {",
    "33:           role: 'system',",
    "34:           content:",
    "35:             'You are a front-end developer that is an expert in semantic HTML. You are helping a colleague improve the semantic structure of their HTML code to make it more accessible. You are not allowed to change any content or words in the HTML code except for the HTML tags and the attributes of those tags. You can also add new tags or attributes where necessary.',",
    "36:         },",
    "37:         { role: 'user', content: prompt },",
    "38:       ],",
    "39:     });",
    "40: ",
    "41:     const improvedHtml = completion.choices?.[0]?.message?.content || '';",
    "42: ",
    "43:     if (!improvedHtml) {",
    "44:       throw new Error('No improved HTML was returned.');",
    "45:     }",
    "46: ",
    "47:     await fs.writeFile(htmlFilePath, improvedHtml, 'utf8');",
    "48: ",
    "49:     console.log(`The file ${htmlFilePath} has been updated successfully.`);",
    "50: ",
    "51:     if (openVSCode) {",
    "52:       exec(`git difftool ${htmlFilePath}`, (error, stdout, stderr) => {",
    "53:         if (error) {",
    "54:           console.log(",
    "55:             'Failed to open VSCode with git difftool. Make sure git is installed and configured correctly.',",
    "56:           );",
    "57:           return;",
    "58:         }",
    "59:         if (stderr) {",
    "60:           console.log(`stderr: ${stderr}`);",
    "61:           return;",
    "62:         }",
    "63:         console.log(",
    "64:           `Opened working tree changes for ${htmlFilePath} in VSCode.`,",
    "65:         );",
    "66:       });",
    "67:     }",
    "68: ",
    "69:     return improvedHtml;",
    "70:   } catch (error) {",
    "71:     console.error('An error occurred:', error);",
    "72:     throw error;",
    "73:   }",
    "74: }",
    "75: ",
    "76: async function improveSemantics(htmlFilePath: string, openAIApiKey: string) {",
    "77:   try {",
    "78:     const improvedHtml = await improveHtmlSemantics({",
    "79:       htmlFilePath,",
    "80:       openAIApiKey,",
    "81:       openAIModel: 'gpt-4o-mini',",
    "82:       openVSCode: true,",
    "83:     });",
    "84: ",
    "85:     console.log('HTML semantics improved successfully.');",
    "86:   } catch (error) {",
    "87:     console.error('Error improving HTML:', error);",
    "88:   }",
    "89: }",
    "90: ",
    "91: const assessAccessibility = async (flag: boolean) => {",
    "92:   const browser = await puppeteer.launch();",
    "93:   const page = await browser.newPage();",
    "94:   await page.goto(`http://localhost:3000`);",
    "95: ",
    "96:   const results = await new AxePuppeteer(page).analyze();",
    "97: ",
    "98:   let p2 = 0; // Critical and Serious issues",
    "99:   let p1 = 0; // Moderate issues",
    "100:   let p0 = 0; // Minor issues",
    "101: ",
    "102:   results.violations.forEach((violation) => {",
    "103:     violation.nodes.forEach((node) => console.log(node));",
    "104:   });",
    "105: ",
    "106:   // Count issues by impact",
    "107:   results.violations.forEach((violation) => {",
    "108:     switch (violation.impact) {",
    "109:       case 'critical':",
    "110:       case 'serious':",
    "111:         p2 += violation.nodes.length;",
    "112:         break;",
    "113:       case 'moderate':",
    "114:         p1 += violation.nodes.length;",
    "115:         break;",
    "116:       case 'minor':",
    "117:         p0 += violation.nodes.length;",
    "118:         break;",
    "119:     }",
    "120:   });",
    "121: ",
    "122:   // Calculate the raw score",
    "123:   const rawScore = (0.4 * p2 + 0.8 * p1 + p0) / (p1 + p2 + p0);",
    "124: ",
    "125:   // Optionally weight the score",
    "126:   const weightedScore = 500 + rawScore * 500.0;",
    "127:   console.log(`minor: ${p0} | minor: ${p1} | minor: ${p2}`);",
    "128:   console.log(`Raw score: ${rawScore} | Weighted score: ${weightedScore}`);",
    "129: ",
    "130:   const score = {",
    "131:     rawScore,",
    "132:     weightedScore,",
    "133:     serious: p2,",
    "134:     moderate: p1,",
    "135:     minor: p0,",
    "136:   };",
    "137: ",
    "138:   if (flag) {",
    "139:     await fs.writeFile(",
    "140:       'accessibility-results.json',",
    "141:       JSON.stringify(results, null, 2),",
    "142:       'utf8',",
    "143:     );",
    "144: ",
    "145:     await fs.writeFile(",
    "146:       'accessibility-score.json',",
    "147:       JSON.stringify(score, null, 2),",
    "148:       'utf-8',",
    "149:     );",
    "150:   }",
    "151: ",
    "152:   await browser.close();",
    "153: ",
    "154:   const accessibilityResult = { score, results };",
    "155: ",
    "156:   return accessibilityResult;",
    "157: };",
    "158: ",
    "159: // Export functions for use as a module",
    "160: // export { improveSemantics, improveHtmlSemantics, init, assessAccessibility };",
    "161: "
  ],
  "src/utils.test.ts": [
    "1: // import { add } from './utils.js';",
    "2: // import { test, expect } from 'vitest';",
    "3: ",
    "4: // test('add', () => {",
    "5: //   expect(add(1, 2)).toBe(3);",
    "6: // });",
    "7: "
  ],
  "src/utils.js": [
    "1: 'use strict';",
    "2: var __awaiter =",
    "3:   (this && this.__awaiter) ||",
    "4:   function (thisArg, _arguments, P, generator) {",
    "5:     function adopt(value) {",
    "6:       return value instanceof P",
    "7:         ? value",
    "8:         : new P(function (resolve) {",
    "9:             resolve(value);",
    "10:           });",
    "11:     }",
    "12:     return new (P || (P = Promise))(function (resolve, reject) {",
    "13:       function fulfilled(value) {",
    "14:         try {",
    "15:           step(generator.next(value));",
    "16:         } catch (e) {",
    "17:           reject(e);",
    "18:         }",
    "19:       }",
    "20:       function rejected(value) {",
    "21:         try {",
    "22:           step(generator['throw'](value));",
    "23:         } catch (e) {",
    "24:           reject(e);",
    "25:         }",
    "26:       }",
    "27:       function step(result) {",
    "28:         result.done",
    "29:           ? resolve(result.value)",
    "30:           : adopt(result.value).then(fulfilled, rejected);",
    "31:       }",
    "32:       step((generator = generator.apply(thisArg, _arguments || [])).next());",
    "33:     });",
    "34:   };",
    "35: var __generator =",
    "36:   (this && this.__generator) ||",
    "37:   function (thisArg, body) {",
    "38:     var _ = {",
    "39:         label: 0,",
    "40:         sent: function () {",
    "41:           if (t[0] & 1) throw t[1];",
    "42:           return t[1];",
    "43:         },",
    "44:         trys: [],",
    "45:         ops: [],",
    "46:       },",
    "47:       f,",
    "48:       y,",
    "49:       t,",
    "50:       g;",
    "51:     return (",
    "52:       (g = { next: verb(0), throw: verb(1), return: verb(2) }),",
    "53:       typeof Symbol === 'function' &&",
    "54:         (g[Symbol.iterator] = function () {",
    "55:           return this;",
    "56:         }),",
    "57:       g",
    "58:     );",
    "59:     function verb(n) {",
    "60:       return function (v) {",
    "61:         return step([n, v]);",
    "62:       };",
    "63:     }",
    "64:     function step(op) {",
    "65:       if (f) throw new TypeError('Generator is already executing.');",
    "66:       while ((g && ((g = 0), op[0] && (_ = 0)), _))",
    "67:         try {",
    "68:           if (",
    "69:             ((f = 1),",
    "70:             y &&",
    "71:               (t =",
    "72:                 op[0] & 2",
    "73:                   ? y['return']",
    "74:                   : op[0]",
    "75:                     ? y['throw'] || ((t = y['return']) && t.call(y), 0)",
    "76:                     : y.next) &&",
    "77:               !(t = t.call(y, op[1])).done)",
    "78:           )",
    "79:             return t;",
    "80:           if (((y = 0), t)) op = [op[0] & 2, t.value];",
    "81:           switch (op[0]) {",
    "82:             case 0:",
    "83:             case 1:",
    "84:               t = op;",
    "85:               break;",
    "86:             case 4:",
    "87:               _.label++;",
    "88:               return { value: op[1], done: false };",
    "89:             case 5:",
    "90:               _.label++;",
    "91:               y = op[1];",
    "92:               op = [0];",
    "93:               continue;",
    "94:             case 7:",
    "95:               op = _.ops.pop();",
    "96:               _.trys.pop();",
    "97:               continue;",
    "98:             default:",
    "99:               if (",
    "100:                 !((t = _.trys), (t = t.length > 0 && t[t.length - 1])) &&",
    "101:                 (op[0] === 6 || op[0] === 2)",
    "102:               ) {",
    "103:                 _ = 0;",
    "104:                 continue;",
    "105:               }",
    "106:               if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {",
    "107:                 _.label = op[1];",
    "108:                 break;",
    "109:               }",
    "110:               if (op[0] === 6 && _.label < t[1]) {",
    "111:                 _.label = t[1];",
    "112:                 t = op;",
    "113:                 break;",
    "114:               }",
    "115:               if (t && _.label < t[2]) {",
    "116:                 _.label = t[2];",
    "117:                 _.ops.push(op);",
    "118:                 break;",
    "119:               }",
    "120:               if (t[2]) _.ops.pop();",
    "121:               _.trys.pop();",
    "122:               continue;",
    "123:           }",
    "124:           op = body.call(thisArg, _);",
    "125:         } catch (e) {",
    "126:           op = [6, e];",
    "127:           y = 0;",
    "128:         } finally {",
    "129:           f = t = 0;",
    "130:         }",
    "131:       if (op[0] & 5) throw op[1];",
    "132:       return { value: op[0] ? op[1] : void 0, done: true };",
    "133:     }",
    "134:   };",
    "135: Object.defineProperty(exports, '__esModule', { value: true });",
    "136: exports.getValue = exports.add = void 0;",
    "137: exports.improveSemantics = improveSemantics;",
    "138: var openai_1 = require('openai');",
    "139: var fs = require('fs/promises');",
    "140: var child_process_1 = require('child_process');",
    "141: var add = function (a, b) {",
    "142:   return a + b;",
    "143: };",
    "144: exports.add = add;",
    "145: var getValue = function (value) {",
    "146:   return console.log(value);",
    "147: };",
    "148: exports.getValue = getValue;",
    "149: function improveSemantics() {",
    "150:   return __awaiter(this, void 0, void 0, function () {",
    "151:     var improvedHtml, error_1;",
    "152:     return __generator(this, function (_a) {",
    "153:       switch (_a.label) {",
    "154:         case 0:",
    "155:           _a.trys.push([0, 2, , 3]);",
    "156:           return [",
    "157:             4 /*yield*/,",
    "158:             improveHtmlSemantics({",
    "159:               htmlFilePath: './index.html',",
    "160:               openAIApiKey: 'your-api-key-here',",
    "161:               openAIModel: 'gpt-4o-mini',",
    "162:               openVSCode: true,",
    "163:             }),",
    "164:           ];",
    "165:         case 1:",
    "166:           improvedHtml = _a.sent();",
    "167:           console.log('Improved HTML:', improvedHtml);",
    "168:           return [3 /*break*/, 3];",
    "169:         case 2:",
    "170:           error_1 = _a.sent();",
    "171:           console.error('Error improving HTML:', error_1);",
    "172:           return [3 /*break*/, 3];",
    "173:         case 3:",
    "174:           return [2 /*return*/];",
    "175:       }",
    "176:     });",
    "177:   });",
    "178: }",
    "179: function improveHtmlSemantics(_a) {",
    "180:   return __awaiter(this, arguments, void 0, function (_b) {",
    "181:     var client, htmlContent, prompt_1, completion, improvedHtml, error_2;",
    "182:     var htmlFilePath = _b.htmlFilePath,",
    "183:       openAIApiKey = _b.openAIApiKey,",
    "184:       _c = _b.openAIModel,",
    "185:       openAIModel = _c === void 0 ? 'gpt-4o-mini' : _c,",
    "186:       _d = _b.openVSCode,",
    "187:       openVSCode = _d === void 0 ? false : _d;",
    "188:     return __generator(this, function (_e) {",
    "189:       switch (_e.label) {",
    "190:         case 0:",
    "191:           client = new openai_1.OpenAI({ apiKey: openAIApiKey });",
    "192:           _e.label = 1;",
    "193:         case 1:",
    "194:           _e.trys.push([1, 5, , 6]);",
    "195:           return [4 /*yield*/, fs.readFile(htmlFilePath, 'utf8')];",
    "196:         case 2:",
    "197:           htmlContent = _e.sent();",
    "198:           prompt_1 =",
    "199:             'Please make the following HTML more semantic and accessible. Consider using header tags instead of just <p> or using <section>/<article> instead of <div> where appropriate. Do not response with any other words or content EXCEPT for the html code. Also do not include html at the start or at the end. This is extremely important. Here is the HTML content:\\n\\n'.concat(",
    "200:               htmlContent,",
    "201:             );",
    "202:           return [",
    "203:             4 /*yield*/,",
    "204:             client.chat.completions.create({",
    "205:               model: openAIModel,",
    "206:               messages: [",
    "207:                 {",
    "208:                   role: 'system',",
    "209:                   content:",
    "210:                     'You are a front-end developer that is an expert in semantic HTML. You are helping a colleague improve the semantic structure of their HTML code to make it more accessible. You are not allowed to change any content or words in the HTML code except for the HTML tags and the attributes of those tags. You can also add new tags or attributes where necessary.',",
    "211:                 },",
    "212:                 { role: 'user', content: prompt_1 },",
    "213:               ],",
    "214:             }),",
    "215:           ];",
    "216:         case 3:",
    "217:           completion = _e.sent();",
    "218:           improvedHtml = completion.choices[0].message.content || '';",
    "219:           return [",
    "220:             4 /*yield*/,",
    "221:             fs.writeFile(htmlFilePath, improvedHtml, 'utf8'),",
    "222:           ];",
    "223:         case 4:",
    "224:           _e.sent();",
    "225:           console.log(",
    "226:             'The file '.concat(htmlFilePath, ' has been updated successfully.'),",
    "227:           );",
    "228:           if (openVSCode) {",
    "229:             (0, child_process_1.exec)(",
    "230:               'git difftool '.concat(htmlFilePath),",
    "231:               function (error, stdout, stderr) {",
    "232:                 if (error) {",
    "233:                   console.log(",
    "234:                     'Failed to open VSCode with git difftool. Make sure git is installed and configured correctly.',",
    "235:                   );",
    "236:                   return;",
    "237:                 }",
    "238:                 if (stderr) {",
    "239:                   console.log('stderr: '.concat(stderr));",
    "240:                   return;",
    "241:                 }",
    "242:                 console.log(",
    "243:                   'Opened working tree changes for '.concat(",
    "244:                     htmlFilePath,",
    "245:                     ' in VSCode.',",
    "246:                   ),",
    "247:                 );",
    "248:               },",
    "249:             );",
    "250:           }",
    "251:           return [2 /*return*/, improvedHtml];",
    "252:         case 5:",
    "253:           error_2 = _e.sent();",
    "254:           console.error('An error occurred:', error_2);",
    "255:           throw error_2;",
    "256:         case 6:",
    "257:           return [2 /*return*/];",
    "258:       }",
    "259:     });",
    "260:   });",
    "261: }",
    "262: improveSemantics();",
    "263: "
  ],
  "src/index.ts": [
    "1: import { init } from '@/utils/init';",
    "2: import { check } from '@/utils/check';",
    "3: import { fixFile, fixRepo } from '@/utils/fix';",
    "4: ",
    "5: export { init, check, fixFile, fixRepo };",
    "6: "
  ],
  "src/index.html": [
    "1: <!doctype html>",
    "2: <html>",
    "3:   <head>",
    "4:     <title>My HTML Page</title>",
    "5:   </head>",
    "6:   <body>",
    "7:     <div>",
    "8:       <p>Welcome to my website!</p>",
    "9:       <p>This is the first div.</p>",
    "10:     </div>",
    "11: ",
    "12:     <div>",
    "13:       <p>About Me</p>",
    "14:       <p>I am a web developer.</p>",
    "15:     </div>",
    "16: ",
    "17:     <div>",
    "18:       <p>Contact Information</p>",
    "19:       <p>Email: example@example.com</p>",
    "20:       <p>Phone: 123-456-7890</p>",
    "21:     </div>",
    "22:   </body>",
    "23: </html>",
    "24: "
  ],
  "src/cli.ts": [
    "1: #!/usr/bin/env node",
    "2: import { Command } from 'commander';",
    "3: import inquirer from 'inquirer';",
    "4: import * as dotenv from 'dotenv';",
    "5: import * as fs from 'fs';",
    "6: import path from 'path';",
    "7: import { init, check, fixFile, fixRepo } from './index';",
    "8: import { DIR_PATH } from './helpers/config';",
    "9: ",
    "10: const program = new Command();",
    "11: dotenv.config();",
    "12: ",
    "13: program",
    "14:   .name('guidedog')",
    "15:   .description(",
    "16:     'An AI powered code library to assist web-developers create more accessible websites and applications.',",
    "17:   )",
    "18:   .version('1.0.0');",
    "19: ",
    "20: program",
    "21:   .command('init')",
    "22:   .description('Initialize the accessibility config for the repo')",
    "23:   .action(async () => {",
    "24:     console.log('Starting init...');",
    "25:     try {",
    "26:       let apiKey: string = process.env.OPENAI_API_KEY || '';",
    "27: ",
    "28:       if (apiKey) {",
    "29:         console.log('OpenAI API key found in environment variables');",
    "30: ",
    "31:         const useExistingKeyResponse = await inquirer.prompt({",
    "32:           type: 'confirm',",
    "33:           name: 'useExistingKey',",
    "34:           message: 'Do you want to use the existing API key?',",
    "35:           default: true,",
    "36:         });",
    "37: ",
    "38:         if (!useExistingKeyResponse.useExistingKey) {",
    "39:           apiKey = ''; // clear api key so it triggers the next input prompt",
    "40:         }",
    "41:       }",
    "42: ",
    "43:       if (!apiKey) {",
    "44:         console.log('OpenAI API key not found in environment variables');",
    "45:         const apiKeyResponse = await inquirer.prompt({",
    "46:           type: 'input',",
    "47:           name: 'apiKey',",
    "48:           message: 'Enter your OpenAI API key:',",
    "49:           validate: (input) => input.length > 0 || 'API key cannot be empty',",
    "50:         });",
    "51: ",
    "52:         apiKey = apiKeyResponse.apiKey;",
    "53:       }",
    "54: ",
    "55:       const answers = await inquirer.prompt({",
    "56:         type: 'list',",
    "57:         name: 'framework',",
    "58:         message: 'What framework are you using?',",
    "59:         choices: ['React', 'Angular', 'Vue', 'Other'],",
    "60:       });",
    "61: ",
    "62:       await init(apiKey, answers.framework);",
    "63:       console.log('✅ Init completed!');",
    "64:     } catch (error) {",
    "65:       program.error(`❌ Error during initialization:\\n${error}`);",
    "66:     }",
    "67:   });",
    "68: ",
    "69: program",
    "70:   .command('check')",
    "71:   .description('Check accessibility of your project')",
    "72:   .option('-r, --report', 'Generate a detailed accessibility report')",
    "73:   .option('-s, --score', 'Assess accessibility score')",
    "74:   .action(async (options) => {",
    "75:     try {",
    "76:       console.log('Starting check...');",
    "77: ",
    "78:       if (options.report) {",
    "79:         await check('report');",
    "80:       } else if (options.score) {",
    "81:         await check('score');",
    "82:       } else {",
    "83:         await check();",
    "84:       }",
    "85: ",
    "86:       console.log('✅ Check completed!');",
    "87:       console.log('Ctrl + C to exit.');",
    "88:     } catch (error) {",
    "89:       program.error(`❌Error during checking:\\n${error}`);",
    "90:       console.log('Ctrl + C to exit.');",
    "91:     }",
    "92:   });",
    "93: ",
    "94: // TODO: Add option for fixFile",
    "95: program",
    "96:   .command('fix')",
    "97:   .description('Fix accessibility issues')",
    "98:   .action(async () => {",
    "99:     console.log('Starting fix...');",
    "100: ",
    "101:     try {",
    "102:       const scopeRes = await inquirer.prompt({",
    "103:         type: 'list',",
    "104:         name: 'scope',",
    "105:         message: 'Do you want to fix the whole repository or a specific file?',",
    "106:         choices: ['Whole repo', 'Specific file'],",
    "107:       });",
    "108: ",
    "109:       if (scopeRes.scope == 'Specific file') {",
    "110:         const fileRes = await inquirer.prompt({",
    "111:           type: 'input',",
    "112:           name: 'filePath',",
    "113:           message: 'Enter your OpenAI API key:',",
    "114:           validate: async (input) => {",
    "115:             const file = path.join(DIR_PATH, input);",
    "116: ",
    "117:             if (fs.existsSync(file)) {",
    "118:               return input.length > 0 || 'File path cannot be empty';",
    "119:             }",
    "120: ",
    "121:             return 'File does not exist';",
    "122:           },",
    "123:         });",
    "124: ",
    "125:         const file = path.join(DIR_PATH, fileRes.filePath);",
    "126:         fixFile(file);",
    "127:       } else {",
    "128:         fixRepo();",
    "129:       }",
    "130: ",
    "131:       console.log('✅ Fix completed!');",
    "132:     } catch (error) {",
    "133:       program.error(`❌ Error during fixing:\\n${error}`);",
    "134:     }",
    "135:   });",
    "136: ",
    "137: program.parse(process.argv);",
    "138: "
  ],
  "TestFiles/missingformlabels.html": [
    "1: <!doctype html>",
    "2: <html lang=\"en\">",
    "3:   <head>",
    "4:     <meta charset=\"UTF-8\" />",
    "5:     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />",
    "6:     <title>Missing Form Labels</title>",
    "7:   </head>",
    "8:   <body>",
    "9:     <h1>Form Without Labels</h1>",
    "10:     <form>",
    "11:       <input type=\"text\" placeholder=\"Enter your name\" />",
    "12:       <input type=\"email\" placeholder=\"Enter your email\" />",
    "13:       <button type=\"submit\">Submit</button>",
    "14:     </form>",
    "15:   </body>",
    "16: </html>",
    "17: "
  ],
  "TestFiles/missingbutton.html": [
    "1: <!doctype html>",
    "2: <html lang=\"en\">",
    "3:   <head>",
    "4:     <meta charset=\"UTF-8\" />",
    "5:     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />",
    "6:     <title>Empty Button Label</title>",
    "7:   </head>",
    "8:   <body>",
    "9:     <h1>Button with No Label</h1>",
    "10:     <button aria-label=\"\">Click me</button>",
    "11:   </body>",
    "12: </html>",
    "13: "
  ],
  "TestFiles/htmlsample.html": [
    "1: <!doctype html>",
    "2: <html lang=\"en\">",
    "3:   <head>",
    "4:     <meta charset=\"UTF-8\" />",
    "5:     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />",
    "6:     <title>Sample Plain HTML</title>",
    "7:   </head>",
    "8:   <body>",
    "9:     <h1>Welcome to Our Website</h1>",
    "10:     <p>This is a sample paragraph with some <a href=\"#\">links</a>.</p>",
    "11:     <img src=\"image.jpg\" alt=\"\" />",
    "12:     <button onclick=\"alert('Button clicked!')\">Click me</button>",
    "13:     <input type=\"text\" placeholder=\"Type here\" />",
    "14:   </body>",
    "15: </html>",
    "16: "
  ],
  "TestFiles/ariaissue.html": [
    "1: <!doctype html>",
    "2: <html lang=\"en\">",
    "3:   <head>",
    "4:     <meta charset=\"UTF-8\" />",
    "5:     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />",
    "6:     <title>ARIA Sample</title>",
    "7:   </head>",
    "8:   <body>",
    "9:     <div role=\"navigation\">",
    "10:       <a href=\"#\" role=\"button\">Link as Button</a>",
    "11:     </div>",
    "12:     <div aria-hidden=\"true\">",
    "13:       <h2>This heading is hidden from assistive technologies</h2>",
    "14:     </div>",
    "15:     <button aria-label=\"\">No label here</button>",
    "16:   </body>",
    "17: </html>",
    "18: "
  ],
  "TestFiles/angularsample.ts": [
    "1: // import { Component } from '@angular/core';",
    "2: ",
    "3: // @Component({",
    "4: //   selector: 'app-sample',",
    "5: //   template: `",
    "6: //     <h2>Angular Sample Component</h2>",
    "7: //     <img src=\"example.png\" alt=\"\">",
    "8: //     <button (click)=\"onClick()\">Submit</button>",
    "9: //     <input type=\"text\" placeholder=\"Search...\">",
    "10: //     <p>This paragraph has <a href=\"#\">a link</a>.</p>",
    "11: //   `",
    "12: // })",
    "13: // export class SampleComponent {",
    "14: //   onClick() {",
    "15: //     alert('Form submitted!');",
    "16: //   }",
    "17: // }",
    "18: "
  ],
  "src/utils/init.ts": [
    "1: import { initConfig, saveAPIKey } from '@/helpers/config';",
    "2: import { createOpenAIClient } from '@/helpers/OpenaiClient';",
    "3: ",
    "4: // Start Generation Here",
    "5: async function init(apiKey: string, framework: string) {",
    "6:   try {",
    "7:     saveAPIKey(apiKey);",
    "8: ",
    "9:     createOpenAIClient();",
    "10: ",
    "11:     const _config = {",
    "12:       framework: framework,",
    "13:     };",
    "14: ",
    "15:     await initConfig(_config);",
    "16:   } catch (error) {",
    "17:     throw error;",
    "18:   }",
    "19: }",
    "20: ",
    "21: export { init };",
    "22: "
  ],
  "src/utils/fix.ts": [
    "1: import { getRepoSuggestions } from '@/helpers/ModelHandler';",
    "2: import * as dotenv from 'dotenv';",
    "3: import path from 'path';",
    "4: ",
    "5: export async function fixFile(dir: string) {",
    "6:   console.log(`fix specific file at [${dir}]`);",
    "7: }",
    "8: ",
    "9: async function fixRepo() {",
    "10:   try {",
    "11:     dotenv.config();",
    "12:     const apiKey = process.env.OPENAI_API_KEY;",
    "13:     const directoryPath = path.join(process.cwd(), '.guidedog');",
    "14:     let configObj = await import(",
    "15:       path.join(directoryPath, 'guidedog.config.cjs')",
    "16:     );",
    "17: ",
    "18:     if (apiKey != null) {",
    "19:       const assistantId = configObj.default.assistantId;",
    "20:       const contextId = configObj.default.contextId;",
    "21: ",
    "22:       console.log('to do: fix whole repo');",
    "23:       return [];",
    "24:     } else {",
    "25:       throw new Error('No API Key found');",
    "26:     }",
    "27:   } catch (error) {",
    "28:     console.log('Error getting suggestions for the Repo: ' + error);",
    "29:   }",
    "30: }",
    "31: ",
    "32: export { fixRepo };",
    "33: "
  ],
  "src/utils/check.ts": [
    "1: import * as fs from 'fs';",
    "2: import {",
    "3:   getConfig,",
    "4:   DIR_PATH,",
    "5:   LATEST_RUN_PATH,",
    "6:   createNewRun,",
    "7: } from '@/helpers/config';",
    "8: import path from 'path';",
    "9: import { analyse } from '@/helpers/Axecore';",
    "10: import { getUploadingFiles, runCodeScan } from '@/helpers/CodeBaseScan';",
    "11: import { createfileLineBreakdown } from '@/helpers/FileLineBreakdown';",
    "12: import { getRepoSuggestions } from '@/helpers/ModelHandler';",
    "13: import * as dotenv from 'dotenv';",
    "14: ",
    "15: dotenv.config();",
    "16: ",
    "17: export async function check(flag?: string) {",
    "18:   try {",
    "19:     const _config = await getConfig();",
    "20: ",
    "21:     if (!_config) {",
    "22:       throw new Error('Something wrong with configuration file');",
    "23:     }",
    "24: ",
    "25:     const { timestamp, newRunPath } = createNewRun();",
    "26: ",
    "27:     // analyse to get axe-core score and violations",
    "28:     // const results = await analyse(_config?.framework, newRunPath, timestamp);",
    "29: ",
    "30:     const filePaths = await runCodeScan();",
    "31: ",
    "32:     const fileLineBreakdownPath = createfileLineBreakdown(",
    "33:       filePaths,",
    "34:       newRunPath,",
    "35:       timestamp,",
    "36:     );",
    "37: ",
    "38:     console.log(\"Getting suggestions...\");",
    "39:     const suggestions = await getRepoSuggestions(fileLineBreakdownPath);",
    "40: ",
    "41:     // if (flag === 'score') {",
    "42:     //   return results.score;",
    "43:     // }",
    "44: ",
    "45:     if (flag === 'report') {",
    "46:       // Write suggestions to guidedog folder",
    "47:       fs.writeFileSync(",
    "48:         `${DIR_PATH}/suggestions.json`,",
    "49:         JSON.stringify(suggestions, null, 2),",
    "50:         {",
    "51:           encoding: 'utf8',",
    "52:           flag: 'w',",
    "53:         },",
    "54:       );",
    "55: ",
    "56:       // Write suggestions to latest run for historical purposes",
    "57:       fs.writeFileSync(",
    "58:         `${LATEST_RUN_PATH}/suggestions.json`,",
    "59:         JSON.stringify(suggestions, null, 2),",
    "60:         {",
    "61:           encoding: 'utf8',",
    "62:           flag: 'w',",
    "63:         },",
    "64:       );",
    "65:     }",
    "66: ",
    "67:     return suggestions;",
    "68:   } catch (error) {",
    "69:     throw error;",
    "70:   }",
    "71: }",
    "72: "
  ],
  "src/helpers/readIgnore.ts": [
    "1: import fs from 'fs';",
    "2: import path from 'path';",
    "3: ",
    "4: export function readIgnore() {",
    "5:   const ignorePath = path.join(process.cwd(), '.guidedogignore');",
    "6: ",
    "7:   try {",
    "8:     const data = fs.readFileSync(ignorePath, 'utf-8');",
    "9: ",
    "10:     const ignorePatterns = data",
    "11:       .split('\\n')",
    "12:       .map((line) => line.trim())",
    "13:       .filter((line) => line && !line.startsWith('#')); // Filter out empty lines and comments",
    "14: ",
    "15:     return ignorePatterns;",
    "16:   } catch (error) {",
    "17:     return [];",
    "18:   }",
    "19: }",
    "20: "
  ],
  "src/helpers/config.ts": [
    "1: import { OpenAI } from 'openai';",
    "2: import * as fs from 'fs';",
    "3: import path from 'path';",
    "4: import _ from 'lodash';",
    "5: import wcag from '@/data/wcag.json';",
    "6: ",
    "7: interface IConfig {",
    "8:   framework?: string;",
    "9:   assistantId?: string;",
    "10:   contextId?: string;",
    "11:   rules?: any;",
    "12: }",
    "13: ",
    "14: export const DIR_PATH = path.join(process.cwd(), '.guidedog');",
    "15: export const CONFIG_PATH = path.join(DIR_PATH, 'guidedog.config.cjs');",
    "16: export const RUNS_PATH = path.join(DIR_PATH, 'runs');",
    "17: export let LATEST_RUN_PATH = '';",
    "18: ",
    "19: export async function initConfig(_config: IConfig) {",
    "20:   try {",
    "21:     if (!fs.existsSync(DIR_PATH)) {",
    "22:       fs.mkdirSync(DIR_PATH);",
    "23:     }",
    "24: ",
    "25:     if (fs.existsSync(CONFIG_PATH)) {",
    "26:       let configObj = await import(CONFIG_PATH);",
    "27:       configObj = _.merge(configObj.default, _config); // Deep merge the configurations",
    "28: ",
    "29:       fs.writeFileSync(",
    "30:         CONFIG_PATH,",
    "31:         `module.exports = ${JSON.stringify(configObj, null, 2)};`,",
    "32:       );",
    "33:     } else {",
    "34:       // Write the new config object to the file",
    "35:       fs.writeFileSync(",
    "36:         CONFIG_PATH,",
    "37:         `module.exports = ${JSON.stringify(_config, null, 2)};`,",
    "38:         { encoding: 'utf-8' },",
    "39:       );",
    "40:     }",
    "41: ",
    "42:     fs.writeFileSync(path.join(DIR_PATH, 'wcag.json'), JSON.stringify(wcag), {",
    "43:       encoding: 'utf-8',",
    "44:     });",
    "45:   } catch (error) {",
    "46:     throw error;",
    "47:   }",
    "48: }",
    "49: ",
    "50: export const getConfig = async (): Promise<IConfig> => {",
    "51:   try {",
    "52:     const _config: IConfig = (await import(CONFIG_PATH)).default;",
    "53: ",
    "54:     if (!_config) {",
    "55:       throw new Error('Configuration file can not be found');",
    "56:     }",
    "57: ",
    "58:     return _config;",
    "59:   } catch (error) {",
    "60:     throw error;",
    "61:   }",
    "62: };",
    "63: ",
    "64: export async function updateConfig(",
    "65:   assistant: OpenAI.Beta.Assistants.Assistant,",
    "66: ) {",
    "67:   // Read existing config or create a new one",
    "68:   let config: { assistantId: string } = { assistantId: '' }; // TODO: make this a proper config object",
    "69: ",
    "70:   try {",
    "71:     const existingConfig = fs.readFileSync(CONFIG_PATH, {",
    "72:       encoding: 'utf8',",
    "73:     });",
    "74:     config = JSON.parse(existingConfig);",
    "75:     // Append assistantId to the config",
    "76:     config['assistantId'] = assistant.id;",
    "77: ",
    "78:     // Write the updated config back to the file",
    "79:     fs.writeFileSync(",
    "80:       DIR_PATH,",
    "81:       `module.exports = ${JSON.stringify(config, null, 2)};`,",
    "82:       'utf8',",
    "83:     );",
    "84:     console.log('Configuration saved to .guidedog/guidedog.config.cjs');",
    "85:   } catch (error) {",
    "86:     console.log('No existing config found, creating a new one.');",
    "87:   }",
    "88: }",
    "89: ",
    "90: export function createNewRun() {",
    "91:   // .toJSON is an easy way to give us YYYY-MM-DD-${time} format to avoid using '/'s as that causes issues for path names",
    "92:   const timestamp = new Date().toISOString().replace(/[:.]/g, '-');",
    "93: ",
    "94:   const newRunPath = path.join(",
    "95:     process.cwd(),",
    "96:     `.guidedog/runs/run-${timestamp}`,",
    "97:   );",
    "98: ",
    "99:   try {",
    "100:     if (!fs.existsSync(newRunPath)) {",
    "101:       fs.mkdirSync(newRunPath, { recursive: true });",
    "102:     } else {",
    "103:       console.log(",
    "104:         'Run path already exists for this exact time. Returning existing run path.',",
    "105:       );",
    "106:     }",
    "107: ",
    "108:     LATEST_RUN_PATH = newRunPath;",
    "109: ",
    "110:     return { timestamp, newRunPath };",
    "111:   } catch (error) {",
    "112:     throw error;",
    "113:   }",
    "114: }",
    "115: ",
    "116: export async function saveAPIKey(apiKey: string) {",
    "117:   const envPath = path.join(process.cwd(), '.env');",
    "118:   const apiKeyEntry = `OPENAI_API_KEY=${apiKey}`;",
    "119: ",
    "120:   if (fs.existsSync(envPath)) {",
    "121:     const fileContents = fs.readFileSync(envPath, { encoding: 'utf8' });",
    "122: ",
    "123:     if (fileContents.includes('OPENAI_API_KEY=')) {",
    "124:       const updatedContents = fileContents.replace(",
    "125:         /OPENAI_API_KEY=.*/,",
    "126:         apiKeyEntry,",
    "127:       );",
    "128:       fs.writeFileSync(envPath, updatedContents, { encoding: 'utf8' });",
    "129:       console.log('API key updated in .env file.');",
    "130:     } else {",
    "131:       fs.appendFileSync(envPath, `\\n${apiKeyEntry}`, { encoding: 'utf8' });",
    "132:       console.log('API key appended to .env file.');",
    "133:     }",
    "134:   } else {",
    "135:     // Create a new .env file and add the API key",
    "136:     fs.writeFileSync(envPath, apiKeyEntry, { encoding: 'utf8' });",
    "137:     console.log('.env file created and API key added.');",
    "138:   }",
    "139: }",
    "140: "
  ],
  "src/helpers/OpenaiClient.ts": [
    "1: import OpenAI from 'openai';",
    "2: ",
    "3: let openaiClient: OpenAI | null = null;",
    "4: ",
    "5: export function createOpenAIClient(): OpenAI {",
    "6:   try {",
    "7:     if (!openaiClient) {",
    "8:       const apiKey = process.env.OPENAI_API_KEY || undefined;",
    "9: ",
    "10:       if (!apiKey) {",
    "11:         throw new Error('API Key cannot be found');",
    "12:       }",
    "13: ",
    "14:       openaiClient = new OpenAI({ apiKey });",
    "15:     } else {",
    "16:       console.log('OpenAI client already initialized.');",
    "17:     }",
    "18:     return openaiClient;",
    "19:   } catch (error) {",
    "20:     throw error;",
    "21:   }",
    "22: }",
    "23: ",
    "24: export function getOpenAIClient(): OpenAI {",
    "25:   if (!openaiClient) {",
    "26:     openaiClient = createOpenAIClient();",
    "27:   }",
    "28: ",
    "29:   return openaiClient;",
    "30: }",
    "31: "
  ],
  "src/helpers/ModelHandler.ts": [
    "1: import * as fs from 'fs';",
    "2: import { getOpenAIClient } from './OpenaiClient';",
    "3: import { z } from 'zod';",
    "4: import { zodResponseFormat } from 'openai/helpers/zod.mjs';",
    "5: import { DIR_PATH } from './config';",
    "6: ",
    "7: const ResponseFormat = z.object({",
    "8:   suggestions: z.array(",
    "9:     z.object({",
    "10:       fileName: z.string(),",
    "11:       issues: z.array(",
    "12:         z.object({",
    "13:           lineNumber: z.number(),",
    "14:           impact: z.enum(['critical', 'serious', 'moderate', 'minor']),",
    "15:           type: z.string(),",
    "16:           improvement: z.string(),",
    "17:         }),",
    "18:       ),",
    "19:     }),",
    "20:   ),",
    "21: });",
    "22: ",
    "23: export async function getRepoSuggestions(fileLineBreakdownPath: string) {",
    "24:   try {",
    "25:     const openai = getOpenAIClient();",
    "26: ",
    "27:     const files_data = fs.readFileSync(fileLineBreakdownPath, 'utf8');",
    "28:     const wcag_data = fs.readFileSync(`${DIR_PATH}/wcag.json`, 'utf8');",
    "29: ",
    "30:     const prompt = `I am providing you two json files. The first is a line by line breakdown of every front end related file in my codebase. This file is in the format of:",
    "31:           {",
    "32:             \"fileName\": [",
    "33:               \"line 1\",",
    "34:               \"line 2\",",
    "35:               \"line 3\",",
    "36:               ...",
    "37:             ]",
    "38:           } for each file in my codebase. each line represents the exact line of code except for the first characters which indicate the line number, colon and one space e.g. \"3: \" is line 3 in the file.",
    "39: ",
    "40:           From this input data, please use identify any accessibility issues in the codebase according to WCAG 2.2 guidelines. Provide suggestions for code improvements based on the issues identified. Ensure that the suggestions are accurate and adhere to accessibility best practices. ",
    "41: ",
    "42:           The second json file you will receive is the WCAG 2.2 guidelines. Please use these to inform the suggestions you provide.",
    "43: ",
    "44:           Your task is to:",
    "45:           1. Read through the upcoming json file and identify accessibility issues according to WCAG 2.2 guidelines.",
    "46:             - Contextualize your analysis by reviewing the entire file, considering how different elements interact and how they might affect accessibility.",
    "47:           2. Provide solutions based on the issues identified, suggest accurate code improvements.",
    "48:             - Locate the issue: Each issue must have a valid line number\".",
    "49:             - Resolve the issue: Provide one single solution per issue. ",
    "50:             - Skip: If you cannot map or resolve an issue, skip it without generating a solution.",
    "51:             - If the issue can be resolved with a single line of code, provide the original line, not placeholder text (e.g., \"...\").",
    "52:             - Do not do multi line fixes. Just provide the exact line of code that needs to be fixed. You can do multiple suggestions for the same file just one line at a time.",
    "53:             - Ensure that the suggested improvements are functional and adhere to accessibility best practices and correctness.",
    "54:             - If no definitive improvement can be made, provide a message with relevant keywords for users to search and resolve the issue manually.",
    "55:             - The suggestion should be the exact code and nothing else. The code provided is going to replace the exact line of the identified issue. So please ensure you provide the exact code that should replace the line.",
    "56:             - For any quotes required in the suggestion please use single quotes. Do not try to use escape characters as this breaks the response for us. ",
    "57:             - For the type of issue, use the exact title of the issue as per the WCAG 2.2 guidelines.",
    "58:           3. Before returning the suggestions, validate the suggestions and modify them accordingly if not pass any of these validation criteria:",
    "59:             - Validate that the suggestions consider the surrounding code context. This includes ensuring that conditional rendering, variable states, and the overall structure of the component or file are taken into account.",
    "60:             - Suggestions should not introduce new bugs or alter the intended behavior of the application.",
    "61:             - Ensure that the improvements adhere to established accessibility guidelines WCAG 2.2",
    "62:             - Validate that the suggested changes do not negatively affect the visual presentation or user experience.",
    "63:           4. Strictly return a valid JSON, with no extra explanation, text, code block delimiters, or newlines. The JSON should be an array of objects, where each object represents a file with accessibility issues.",
    "64:           5. You must do this for every file provided. There are often multiple files needing accessibility improvements.",
    "65: ",
    "66:           The output must be strictly following this structure:",
    "67:           [",
    "68:             {",
    "69:               fileName:string, //  The name of file having issues",
    "70:               issues: [ // An array of objects, where each object represents an issue in the file",
    "71:                 {",
    "72:                   location: number, // The exact line of the issue.",
    "73:                   impact: string, // The severity of the issue based on axe-core's analysis.",
    "74:                   type: string, // The type/title of accessibility issue, based on predefined WCAG guidelines.",
    "75:                   improvement: string // The suggested code improvement to fix the issue.",
    "76:                 }",
    "77:               ]",
    "78:             }",
    "79:           ]",
    "80: ",
    "81:           HERE IS THE JSON FILE OF THE WCAG 2.2 GUIDELINES:",
    "82: ",
    "83:           ${wcag_data}",
    "84: ",
    "85:           HERE IS THE JSON FILE OF THE LINE BY LINE BREAKDOWN OF MY CODEBASE:",
    "86: ",
    "87:           ${files_data}",
    "88:         `;",
    "89: ",
    "90:     const completion = await openai.beta.chat.completions.parse({",
    "91:       model: 'gpt-4o-mini',",
    "92:       messages: [",
    "93:         {",
    "94:           role: 'system',",
    "95:           content:",
    "96:             'You are an expert frontend developer in ReactJS, VueJS, Angular and Web accessibility and tasked with helping me improve the accessibility of my frontend code according to WCAG 2.2 guidelines.',",
    "97:         },",
    "98:         { role: 'user', content: prompt },",
    "99:       ],",
    "100:       response_format: zodResponseFormat(ResponseFormat, 'response_format'),",
    "101:     });",
    "102: ",
    "103:     const suggestions = completion?.choices[0]?.message.parsed;",
    "104: ",
    "105:     if (!suggestions) {",
    "106:       throw new Error('No suggestions were generated.');",
    "107:     }",
    "108: ",
    "109:     const formattedSuggestions = sanitizeSuggestions(suggestions); ",
    "110: ",
    "111:     return formattedSuggestions;",
    "112:   } catch (error) {",
    "113:     throw error;",
    "114:   }",
    "115: }",
    "116: ",
    "117: // This function sanitize the suggestions. This is to improve consistency of format and can be expanded on over time.",
    "118: const sanitizeSuggestions = (suggestionFile: any) => {",
    "119:     return suggestionFile.suggestions.map((file: any) => ({",
    "120:       ...file,",
    "121:       issues: file.issues.map((issue: any) => ({",
    "122:         ...issue,",
    "123:         // Replace double quotes and escape chars with single quotes",
    "124:         improvement: issue.improvement",
    "125:           .replace(/\"/g, \"'\")",
    "126:           .replace(/\\\\\"/g, \"'\")",
    "127:           .trim(),",
    "128:       })),",
    "129:     }));",
    "130: }",
    "131: ",
    "132: const test = (string: string) => {",
    "133: ",
    "134:   return string",
    "135:   .replace(/\"/g, \"'\")",
    "136:   .replace(/\\\\\"/g, \"'\")",
    "137:   .trim()",
    "138: }",
    "139: ",
    "140: const testString = \"      <label for='name'>Enter your name</label>\\n      <input type='text' id='name' placeholder='Enter your name' />\"",
    "141: console.log(\"sanitised string:\", test(testString));",
    "142: ",
    "143: "
  ],
  "src/helpers/FileLineBreakdown.ts": [
    "1: // src/helpers/createfileLineBreakdown.ts",
    "2: import path from 'path';",
    "3: import * as fs from 'fs';",
    "4: ",
    "5: export function createfileLineBreakdown(",
    "6:   filePaths: string[],",
    "7:   runPath: string,",
    "8:   timestamp: string,",
    "9: ): string {",
    "10:   const fileLineBreakdown: { [key: string]: string[] } = {}; // Initialize as an object",
    "11: ",
    "12:   try {",
    "13:     for (const filePath of filePaths) {",
    "14:       const content: string = fs.readFileSync(filePath, 'utf8'); // Read file as string",
    "15:       const code = content.split('\\n');",
    "16:       fileLineBreakdown[filePath] = code.map(",
    "17:         (line, index) => `${index + 1}: ${line}`,",
    "18:       );",
    "19:     }",
    "20: ",
    "21:     if (!fs.existsSync(runPath)) {",
    "22:       fs.mkdirSync(runPath, { recursive: true });",
    "23:     }",
    "24: ",
    "25:     // Write the mega file to the src directory",
    "26:     const outputPath = path.join(runPath, `files-${timestamp}.json`);",
    "27: ",
    "28:     fs.writeFileSync(",
    "29:       outputPath,",
    "30:       JSON.stringify(fileLineBreakdown, null, 2),",
    "31:       'utf8',",
    "32:     );",
    "33: ",
    "34:     return outputPath;",
    "35:   } catch (error) {",
    "36:     throw error;",
    "37:   }",
    "38: }",
    "39: "
  ],
  "src/helpers/CodeBaseScan.ts": [
    "1: import { glob } from 'glob';",
    "2: import { readIgnore } from '@/helpers/readIgnore';",
    "3: import { RUNS_PATH, DIR_PATH } from './config';",
    "4: ",
    "5: export async function runCodeScan(): Promise<string[]> {",
    "6:   console.log('Scanning...');",
    "7:   const _ignore = readIgnore();",
    "8:   try {",
    "9:     const patterns = [",
    "10:       `**/*.{js,jsx,ts,tsx,html,htm,xhtml,css,scss,less,vue,svelte}`,",
    "11:     ];",
    "12:     const filePaths = await glob(patterns, {",
    "13:       ignore: [",
    "14:         ..._ignore,",
    "15:         'node_modules/**',",
    "16:         '*.json',",
    "17:         '.next/**',",
    "18:         'dist/**',",
    "19:         'build/**',",
    "20:         'public/**',",
    "21:       ],",
    "22:     });",
    "23: ",
    "24:     console.log('Scanning completed');",
    "25:     return filePaths;",
    "26:   } catch (error) {",
    "27:     throw error;",
    "28:   }",
    "29: }",
    "30: ",
    "31: export async function getUploadingFiles(timestamp: string): Promise<string[]> {",
    "32:   try {",
    "33:     const patterns = [",
    "34:       `${DIR_PATH}/wcag.json`,",
    "35:       `${RUNS_PATH}/run-${timestamp}/*`,",
    "36:     ];",
    "37: ",
    "38:     const filePaths = await glob(patterns);",
    "39: ",
    "40:     if (filePaths.length <= 1) {",
    "41:       throw new Error('Missing uploading files!');",
    "42:     }",
    "43: ",
    "44:     return filePaths;",
    "45:   } catch (error) {",
    "46:     throw error;",
    "47:   }",
    "48: }",
    "49: "
  ],
  "src/helpers/Axecore.ts": [
    "1: import { AxePuppeteer } from '@axe-core/puppeteer';",
    "2: import puppeteer from 'puppeteer';",
    "3: import { exec } from 'child_process';",
    "4: import path from 'path';",
    "5: import * as fs from 'fs';",
    "6: ",
    "7: const retry = async (",
    "8:   url: string,",
    "9:   resolve: any,",
    "10:   retries: number = 5,",
    "11:   delay: number = 5000,",
    "12: ) => {",
    "13:   for (let attempt = 0; attempt < retries; attempt++) {",
    "14:     try {",
    "15:       await new Promise((res) => setTimeout(res, delay));",
    "16: ",
    "17:       const response = await fetch(url);",
    "18: ",
    "19:       if (response.ok) {",
    "20:         console.log('Build is up and running.');",
    "21:         resolve();",
    "22:         return;",
    "23:       } else {",
    "24:         console.log(",
    "25:           `Serving attempt ${attempt + 1} failed: Server is not up yet. Retrying...`,",
    "26:         );",
    "27:       }",
    "28:     } catch (error) {",
    "29:       throw new Error(",
    "30:         `Serving attempt ${attempt + 1} failed: ${error}. Retrying...`,",
    "31:       );",
    "32:     }",
    "33:   }",
    "34: ",
    "35:   throw new Error(`Server failed to start after ${retries} attempts.`);",
    "36: };",
    "37: ",
    "38: const build = async (cmd: string) =>",
    "39:   new Promise<void>((resolve, reject) => {",
    "40:     exec(cmd, (error, stdout, stderr) => {",
    "41:       if (error) {",
    "42:         return reject(`Build error: ${error}`);",
    "43:       }",
    "44:       if (stderr) {",
    "45:         return reject(`Build stderr: ${stderr}`);",
    "46:       }",
    "47:       console.log(`Build stdout: ${stdout}`);",
    "48:       resolve();",
    "49:     });",
    "50:   });",
    "51: ",
    "52: const serveBuild = async (cmd: string) =>",
    "53:   new Promise<{ serveProcess: any }>((resolve, reject) => {",
    "54:     const serveProcess = exec(cmd, (error, stdout, stderr) => {",
    "55:       if (error) {",
    "56:         return reject(`Serve error: ${error}`);",
    "57:       }",
    "58:       if (stderr) {",
    "59:         return reject(`Serve stderr: ${stderr}`);",
    "60:       }",
    "61:       console.log(`Serve stdout: ${stdout}`);",
    "62:     });",
    "63: ",
    "64:     const url = 'http://localhost:3000/';",
    "65:     retry(url, () => resolve({ serveProcess })).catch(reject);",
    "66:   });",
    "67: ",
    "68: const stopProcess = (runningProcess: any) => {",
    "69:   try {",
    "70:     process.kill(runningProcess.pid + 1, 'SIGTERM');",
    "71:   } catch (error) {",
    "72:     throw new Error(`Error stopping the server: ${error}`);",
    "73:   }",
    "74: };",
    "75: ",
    "76: export const analyse = async (",
    "77:   framework: string | undefined,",
    "78:   runPath: string,",
    "79:   timestamp: string,",
    "80: ) => {",
    "81:   let serveProcess;",
    "82: ",
    "83:   try {",
    "84:     if (!framework) throw new Error('guidedog.config.cjs cannot be found');",
    "85: ",
    "86:     switch (framework) {",
    "87:       case 'React':",
    "88:         await build('npm run build');",
    "89:         ({ serveProcess } = await serveBuild('npx serve -s build -p 3000'));",
    "90:         break;",
    "91:       case 'Vue':",
    "92:         await build('npx vite build');",
    "93:         ({ serveProcess } = await serveBuild('npx serve -s dist -p 3000'));",
    "94:         break;",
    "95:       case 'Angular':",
    "96:         // await build('npx ng build');",
    "97:         ({ serveProcess } = await serveBuild('npx ng serve --port 3000'));",
    "98:         break;",
    "99:       default:",
    "100:         throw new Error('Unsupported framework');",
    "101:     }",
    "102: ",
    "103:     const browser = await puppeteer.launch();",
    "104:     const page = await browser.newPage();",
    "105:     await page.goto(`http://localhost:3000`);",
    "106: ",
    "107:     const results = await new AxePuppeteer(page).analyze();",
    "108: ",
    "109:     let p2 = 0; // Critical and Serious issues",
    "110:     let p1 = 0; // Moderate issues",
    "111:     let p0 = 0; // Minor issues",
    "112: ",
    "113:     // Count issues by impact",
    "114:     results.violations.forEach((violation) => {",
    "115:       switch (violation.impact) {",
    "116:         case 'critical':",
    "117:         case 'serious':",
    "118:           p2 += violation.nodes.length;",
    "119:           break;",
    "120:         case 'moderate':",
    "121:           p1 += violation.nodes.length;",
    "122:           break;",
    "123:         case 'minor':",
    "124:           p0 += violation.nodes.length;",
    "125:           break;",
    "126:       }",
    "127:     });",
    "128: ",
    "129:     // Calculate the raw score",
    "130:     const rawScore = ((0.4 * p2 + 0.8 * p1 + p0) / (p1 + p2 + p0)).toFixed(2);",
    "131: ",
    "132:     // Optionally weight the score",
    "133:     const weightedScore = 500 + parseFloat(rawScore) * 500.0;",
    "134:     console.log(`minor: ${p0} | moderate: ${p1} | critical: ${p2}`);",
    "135:     console.log(`Raw score: ${rawScore} | Weighted score: ${weightedScore}`);",
    "136: ",
    "137:     const score = {",
    "138:       rawScore,",
    "139:       weightedScore,",
    "140:       serious: p2,",
    "141:       moderate: p1,",
    "142:       minor: p0,",
    "143:     };",
    "144: ",
    "145:     const axeResults = {",
    "146:       testEngine: results.testEngine,",
    "147:       testEnvironment: results.testEnvironment,",
    "148:       timeStamp: results.timestamp,",
    "149:       url: results.url,",
    "150:       violation: results.violations,",
    "151:     };",
    "152: ",
    "153:     await browser.close();",
    "154: ",
    "155:     fs.writeFileSync(",
    "156:       path.join(runPath, `axecore-${timestamp}.json`),",
    "157:       JSON.stringify(axeResults, null, 2),",
    "158:       'utf8',",
    "159:     );",
    "160: ",
    "161:     return { score, axeResults };",
    "162:   } catch (error) {",
    "163:     throw error;",
    "164:   } finally {",
    "165:     if (serveProcess) {",
    "166:       stopProcess(serveProcess);",
    "167:     }",
    "168:   }",
    "169: };",
    "170: "
  ]
}